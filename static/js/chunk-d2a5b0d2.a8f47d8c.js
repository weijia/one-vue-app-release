(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d2a5b0d2"],{"587b":function(t,e,n){},"59ea":function(t,e,n){},"7a8a":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dashboard-editor-container"},[n("fav-search",{on:{encryptSwitchClicked:function(e){return t.encryptSwitchClicked()},tagFiles:t.tagFiles},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),n("div",{staticClass:"block"},[n("el-pagination",{attrs:{"page-sizes":[10,50,100,400],"current-page":t.currentPage,layout:"total, sizes, prev, pager, next, jumper",total:t.rows,"page-size":t.perPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:total":function(e){t.rows=e},"update:pageSize":function(e){t.perPage=e},"update:page-size":function(e){t.perPage=e}}})],1),n("Favorites",{staticClass:"favorites",attrs:{favorites:t.favorites,tags:t.tags}})],1)},r=[],s=n("b85c"),a=(n("d81d"),n("b64b"),n("4e82"),n("79e2")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isFavLoaded?n("div",{staticClass:"favorites",attrs:{id:"#favorites"}},t._l(t.existingFav,(function(t){return n("div",{key:t.id},[n("FavoriteItem",{attrs:{favorite:t}})],1)})),0):t._e()},c=[],l=(n("4de4"),n("d3b7"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.favorite.removed?t._e():n("div",{class:{encrypted:t.favorite.encrypted}},[n("span",{staticClass:"floating-tool-bar"},[n("button",{staticClass:"btn",on:{click:function(e){return t.removeUrl()}}},[n("i",{staticClass:"el-icon-delete"})]),t.isDecryptableFav()?n("button",{staticClass:"btn",on:{click:function(e){return t.decrypt()}}},[n("i",{staticClass:"el-icon-key"})]):t._e(),t.favorite.encrypted?t._e():n("button",{staticClass:"btn",on:{click:function(e){return t.encrypt()}}},[n("i",{staticClass:"el-icon-key"})])]),t.favorite.description?n("a",{attrs:{href:t.url}},[t._v(t._s(t.favorite.description))]):n("a",{attrs:{href:t.url}},[t._v(t._s(t.url))]),t.tags?n("input-tag",{model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}}):t._e()],1)}),u=[],d=n("1c46");function f(t,e){try{var n=d.createCipher("aes192",e),i=n.update(t,"utf8","hex");return i+=n.final("hex"),i}catch(r){return"Can not decrypt"}}function h(t,e){var n=d.createDecipher("aes192",e),i=n.update(t,"hex","utf8");return i+=n.final("utf8"),i}function p(t,e){try{return h(t,e)}catch(n){return"Can not decrypt"}}function g(t,e){try{return h(t,e),!0}catch(n){return!1}}function v(t,e){var n,i=[],r=Object(s["a"])(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;i.push(p(a,e))}}catch(o){r.e(o)}finally{r.f()}return i}function y(t,e){var n,i=[],r=Object(s["a"])(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;i.push(f(a,e))}}catch(o){r.e(o)}finally{r.f()}return i}var m={name:"FavoriteItem",props:{favorite:{type:Object,required:!0}},computed:{url:function(){return this.favorite.encrypted?p(this.favorite.url,this.$store.state.settings.encryptingKey):this.favorite.url},tags:{get:function(){var t=this.favorite.tags;return this.favorite.encrypted&&(t=v(this.favorite.tags,this.$store.state.settings.encryptingKey)),"string"===typeof t&&(t=[t]),t},set:function(t){this.favorite.encrypted?this.favorite.tags=y(t,this.$store.state.settings.encryptingKey):this.favorite.tags=t,this.$pouch.put(this.favorite,{},"favorites")}}},methods:{removeUrl:function(){this.favorite.removed&&(this.favorite.deleted=!0),this.favorite.removed=!0,this.$pouch.put(this.favorite,{},"favorites")},decrypt:function(){this.isDecryptableFav(this.favorite)&&(this.favorite.url=p(this.favorite.url,this.$store.state.settings.encryptingKey),this.favorite.tags=v(this.favorite.tags,this.$store.state.settings.encryptingKey),delete this.favorite.encrypted,this.$pouch.put(this.favorite,{},"favorites"))},encrypt:function(t){this.favorite.encrypted||(this.favorite.url=f(this.favorite.url,this.$store.state.settings.encryptingKey),this.favorite.tags=y(this.favorite.tags,this.$store.state.settings.encryptingKey),this.favorite.encrypted=!0,this.$pouch.put(this.favorite,{},"favorites"))},isDecryptableFav:function(){if(this.favorite.encrypted&&g(this.favorite.url,this.$store.state.settings.encryptingKey))return!0}}},b=m,w=(n("f99d"),n("2877")),k=Object(w["a"])(b,l,u,!1,null,null,null),_=k.exports,$={name:"Favorites",components:{FavoriteItem:_},props:{favorites:{},tags:{type:Array,required:!0}},data:function(){return{url:""}},computed:{existingFav:function(){return this.favorites?this.favorites.filter((function(t){return!t.removed})):[]}},methods:{addUrl:function(t,e){var n=document.getElementById("machineId").textContent;this.$pouch.post({url:t,type:"favorites",machine:n,tags:e,removed:!1},{},"favorites"),this.$emit("url-added")},removeUrl:function(t){t.removed=!0,this.$pouch.put(t,{},"favorites")},clearRemoved:function(t){t.deleted&&this.$pouch.remove(t,{},"favorites")},isFavLoaded:function(t){return console.log(t),t}}},S=$,F=Object(w["a"])(S,o,c,!1,null,null,null),x=F.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("form",{attrs:{autocomplete:"off"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:18}},[n("el-input",{attrs:{id:"search",placeholder:"Serach keyword"},on:{input:function(e){return t.$emit("input",t.keyword)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),n("el-col",{attrs:{span:2}},[n("el-button",{on:{click:function(e){t.isShowAdvanced=!t.isShowAdvanced}}},[t._v(" Show Advanced ")])],1),n("el-col",{attrs:{span:2}},[n("label")]),"state-machine-id"!==t.$store.state.machineId?n("el-col",{attrs:{span:2}},[0==t.taggingFiles.length?n("label",{staticClass:"col",attrs:{id:"drag-file"}},[t._v(" Drag your files here ")]):n("label",{staticClass:"col"},[t._v(t._s(t.taggingFiles))])]):t._e()],1)],1),t.isShowAdvanced?n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:2}},[n("label",{staticClass:"password-label"},[t._v("Password:")])]),n("el-col",{attrs:{span:10}},[n("el-input",{attrs:{id:"password",placeholder:"Password","show-password":""},on:{input:function(e){return t.savePass()}},model:{value:t.encryptingKey,callback:function(e){t.encryptingKey=e},expression:"encryptingKey"}})],1),n("el-button",{on:{click:function(e){t.encryptingKey=""}}},[t._v(" Clear Password ")]),n("el-button",{on:{click:function(e){return t.encryptSwitchClicked()}}},[t.isOnlyShowNotEncrypted?n("label",[t._v("Show Encrypted")]):t._e(),t.isOnlyShowNotEncrypted?t._e():n("label",[t._v("Hide Encrypted")])]),n("span",{staticClass:"debug-info col-sm-2"},[t._v(t._s(t.serverUrl))]),n("span",{staticClass:"debug-inf",attrs:{id:"machineId"}},[t._v(t._s(t.defaultMachineIdText))]),n("span",[t._v(t._s(t.$store.state.machineId))]),n("el-button",{staticClass:"btn",attrs:{id:"sync_m_id"},on:{click:function(e){return t.syncMachineId()}}},[t._v(" Sync machine ID ")]),n("span",{staticClass:"debug-info col"},[t._v(' Encrypting Key: "'+t._s(t.encryptingKey)+'" ')])],1),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-input",{attrs:{placeholder:"New Favorite"},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1),n("el-col",{attrs:{span:6}},[n("input-tag",{model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}})],1),n("el-button",{on:{click:function(e){t.tagFiles(),t.url=""}}},[t._v(" Tag It ")])],1)],1):t._e()])},I=[],O=(n("99af"),{name:"FavSearch",data:function(){return{serverUrl:Object(a["a"])(),tags:[],taggingFiles:[],url:"",keyword:"",isOnlyShowNotEncrypted:!0,perPage:10,currentPage:1,rows:0,defaultMachineIdText:"original machine id",isShowAdvanced:!1}},computed:{encryptingKey:{get:function(){return this.$store.state.settings.encryptingKey},set:function(t){this.$store.dispatch("settings/changeSetting",{key:"encryptingKey",value:t})}}},mounted:function(){var t=document.getElementById("drag-file");t.ondragover=function(){return!1},t.ondragleave=function(){return!1},t.ondragend=function(){return!1};var e=this;t.ondrop=function(t){t.preventDefault();var n,i=Object(s["a"])(t.dataTransfer.files);try{for(i.s();!(n=i.n()).done;){var r=n.value;console.log("File(s) you dragged here: ",r.path),e.taggingFiles=e.taggingFiles.concat(r.path),console.log(e.taggingFiles)}}catch(a){i.e(a)}finally{i.f()}return!1},this.encryptingKey=localStorage.getItem("p"),this.keyword=localStorage.getItem("k")},methods:{savePass:function(){localStorage.setItem("p",this.encryptingKey)},encryptSwitchClicked:function(){this.isOnlyShowNotEncrypted=!this.isOnlyShowNotEncrypted,this.$emit("encryptSwitchClicked"),console.log(this.isOnlyShowNotEncrypted)},tagFiles:function(){""!==this.url&&this.taggingFiles.push(this.url),this.$emit("tagFiles",this.taggingFiles,this.tags,document.getElementById("machineId").textContent),this.taggingFiles=[]}}}),E=O,K=(n("81bc"),Object(w["a"])(E,C,I,!1,null,null,null)),P=K.exports,T="favorites",j={components:{FavSearch:P,Favorites:x},data:function(){return{serverUrl:Object(a["a"])(),tags:[],taggingFiles:[],url:"",keyword:"",isOnlyShowNotEncrypted:!0,perPage:10,currentPage:1,rows:0,defaultMachineIdTex:"original machine id",fullTagList:{}}},computed:{machineId:{get:function(){return this.$store.state.settings.machineId},set:function(t){this.$store.dispatch("settings/changeSetting",{key:"machineId",value:t})}},selectorValue:{get:function(){console.log(this.keyword);var t={type:"favorites",$or:[{url:{$regex:this.keyword}},{description:{$regex:this.keyword}},{tags:{$regex:this.keyword}}]};return this.isOnlyShowNotEncrypted&&(t.encrypted={$exists:!1}),t}},tagList:{get:function(){var t={};for(var e in this.fullTagList){console.log(this.fullTagList[e]);var n=this.fullTagList[e].key,i=this.fullTagList[e].value[0],r=this.fullTagList[e].value[1];if(r){if(this.isOnlyShowNotEncrypted||!g(n))continue;n=p(n)}t[n]?t[n]+=i:t[n]=i}var s=Object.keys(t).map((function(e){return[e,t[e]]}));return s.sort((function(t,e){return e[1]-t[1]})),console.log(s),s}}},pouch:{favorites:function(){return{selector:this.selectorValue,sort:[{timestamp:"desc"}],limit:this.perPage,skip:this.perPage*(this.currentPage-1)}},configs:{}},created:function(){Object(a["b"])(this,T,T),console.log(this.$pouch),this.$pouch.createIndex({index:{fields:["tags","timestamp","url","encrypted","description","removed","deleted"]}}).then((function(t){})).catch((function(t){console.log("create index error: ",t)}))},mounted:function(){var t={map:function(t){t.removed||emit(t)},reduce:"_count"},e=this;this.$pouch.query(t,{reduce:"_count"},"favorites").then((function(t){e.rows=t["rows"][0]["value"]})),this.updateTagList()},methods:{updateTagList:function(){var t=this,e={map:function(t){if(t.tags)if("string"===typeof t.tags)emit(t.tags,t.encrypted);else for(var e in t.tags)emit(t.tags[e],t.encrypted)},reduce:function(t,e){return[e.length,e[0]]}};this.$pouch.query(e,{group:!0},"favorites").then((function(e){t.fullTagList=e.rows}))},saveToLocalStorage:function(t,e){localStorage.setItem(t,e)},encryptSwitchClicked:function(){this.isOnlyShowNotEncrypted=!this.isOnlyShowNotEncrypted},tagFiles:function(t,e,n){var i=this.$store.state.settings.encryptingKey;if(0!==t.length){var r=e;i&&(r=y(e,i));var a,o=Object(s["a"])(t);try{for(o.s();!(a=o.n()).done;){var c=a.value,l={url:c,type:"favorites",tags:r,timestamp:Math.round(+new Date)};n!==this.defaultMachineIdTex&&(l.machine=n),i&&(l.url=f(c,i),l.encrypted=!0),console.log(l),this.$pouch.post(l,{},"favorites")}}catch(u){o.e(u)}finally{o.f()}}},syncMachineId:function(){this.$store.state.machineId=document.getElementById("machineId").textContent}}},L=j,N=(n("fd5b"),Object(w["a"])(L,i,r,!1,null,null,null));e["default"]=N.exports},"81bc":function(t,e,n){"use strict";n("bc61")},bc61:function(t,e,n){},f99d:function(t,e,n){"use strict";n("59ea")},fd5b:function(t,e,n){"use strict";n("587b")}}]);